# 6-2 프로토타입 체인

## 6-2-1 메소드 오버라이드

![Untitled](6-2%20%E1%84%91%E1%85%B3%E1%84%85%E1%85%A9%E1%84%90%E1%85%A9%E1%84%90%E1%85%A1%E1%84%8B%E1%85%B5%E1%86%B8%20%E1%84%8E%E1%85%A6%E1%84%8B%E1%85%B5%E1%86%AB%209d0966da197049a988e78426bbaed6d6/Untitled.png)

자바스크립트 엔진은 메소드를 찾을 때 가장 가까운 대상인 자신의 프로퍼티를 먼저 검색하고, 그 다음 가까운 대상인 __proto__를 검색한다. 즉 __proto__에 있는 메소드는 자신에게 있는 메소드보다 우선 순위에서 밀려 호출되지 않은 것이다.

**메소드 오버라이딩이 된 상태에서 prototype에 있는 메소드에 어떻게 접근할까?**

```jsx
console.log(iu.__proto__.getName());    //undefined
```

→iu.__proto__.getName을 출력했더니 undefined가 나온다. this가 prototype 객체(iu.__proto__)를 가리키는데 prototype에는 name이라는 프로퍼티가 없기 때문이다.

```jsx
Person.prototype.name = '이지금';
console.log(iu.__proto__.getName());    //이지금
```

→prototype에 name이라는 프로퍼티를 부여했더니 값이 잘 출력됨을 볼 수 있다.

but

여기서 this가 instance가 아닌 prototype을 바라보는데 아래와 같이 call 혹은 apply로 이 문제를 해결할 수 있다.

```jsx
console.log(iu.__proto__.getName.call(iu));
```

즉 메서드가 오버라이드된 경우 자신으로부터 가장 가까운 메서드에만 접근할 수 있지만 __proto__의 메서드에도 우회적인 방법으로나마 접근 가능하다.

## 6-2-2 프로토타입 체인

**프로토타입 체인?**

배열 리터럴의 내부 구조를 봤을 때 이 __proto__의 안에는 __proto__가 또 존재함

**프로토타입 체이닝 →** 이렇게 따라가면서 검색하는 것

![Untitled](6-2%20%E1%84%91%E1%85%B3%E1%84%85%E1%85%A9%E1%84%90%E1%85%A9%E1%84%90%E1%85%A1%E1%84%8B%E1%85%B5%E1%86%B8%20%E1%84%8E%E1%85%A6%E1%84%8B%E1%85%B5%E1%86%AB%209d0966da197049a988e78426bbaed6d6/Untitled%201.png)

배열의 내부 구조이다. __proto 안에 또 __proto__가 있는 모습이다. prototype객체가 '객체'이기 때문에 이 객체도 __proto__를 갖고 있는 것이 당연하고, 프로토타입 객체의 __proto__는 Object.prototype을 참조한다.

![Untitled](6-2%20%E1%84%91%E1%85%B3%E1%84%85%E1%85%A9%E1%84%90%E1%85%A9%E1%84%90%E1%85%A1%E1%84%8B%E1%85%B5%E1%86%B8%20%E1%84%8E%E1%85%A6%E1%84%8B%E1%85%B5%E1%86%AB%209d0966da197049a988e78426bbaed6d6/Untitled%202.png)

변수 arr 는 배열이므로 arr.__proto__는 Array.prototype을 참조할 것이고 Array.prototype 또한 객체이므로 Array.prototype.__proto__는 Object.prototype을 참조할 것이다.

![배열처럼 자바스크립트 엔진은 위와 같은 프로토타입 체인을 갖게 된다. 위쪽 삼각형의 우측 꼭짓점에는 무조건 Object.prototype이 위치하게 되지만 삼각형은 꼭 두개만 연결되는 것은 아니다](6-2%20%E1%84%91%E1%85%B3%E1%84%85%E1%85%A9%E1%84%90%E1%85%A9%E1%84%90%E1%85%A1%E1%84%8B%E1%85%B5%E1%86%B8%20%E1%84%8E%E1%85%A6%E1%84%8B%E1%85%B5%E1%86%AB%209d0966da197049a988e78426bbaed6d6/Untitled%203.png)

배열처럼 자바스크립트 엔진은 위와 같은 프로토타입 체인을 갖게 된다. 위쪽 삼각형의 우측 꼭짓점에는 무조건 Object.prototype이 위치하게 되지만 삼각형은 꼭 두개만 연결되는 것은 아니다

## 6-2-3 객체 전용 메소드의 예외사항

어떤 생성자 함수이든 prototype은 반드시 객체이기 때문에 최상단에는 Object.prototype이 존재한다. 따라서 객체에서만 사용할 메소드는 일반적인 경우처럼 프로토타입 객체 안에 정의할 수가 없다. 

![Untitled](6-2%20%E1%84%91%E1%85%B3%E1%84%85%E1%85%A9%E1%84%90%E1%85%A9%E1%84%90%E1%85%A1%E1%84%8B%E1%85%B5%E1%86%B8%20%E1%84%8E%E1%85%A6%E1%84%8B%E1%85%B5%E1%86%AB%209d0966da197049a988e78426bbaed6d6/Untitled%204.png)

![Untitled](6-2%20%E1%84%91%E1%85%B3%E1%84%85%E1%85%A9%E1%84%90%E1%85%A9%E1%84%90%E1%85%A1%E1%84%8B%E1%85%B5%E1%86%B8%20%E1%84%8E%E1%85%A6%E1%84%8B%E1%85%B5%E1%86%AB%209d0966da197049a988e78426bbaed6d6/Untitled%205.png)

Object 내에서만 사용할 의도로 getEntries함수를 생성했지만 11~16번줄의 결과처럼 객체가 아니여도 getEntries()에 접근가능 해 오류없이 결과를 내고 있다.

**Object.prototype에만 정의된 메서드라도 다른 데이터 타입에서 접근 가능하다**. 따라서 객체에서만 사용할 메서드는 다른 데이터 타입처럼 prototype 객체 안에 정의할 수 없음.

따라서 Object 내부에서만 사용할 메서드는 부득이하게 Object.prototype이 아닌 Object에 static 메소드로 부여할 수 밖에 없다. 또한 생성자 함수인 Object와 인스턴스 객체 사이에는 this로 연결이 불가능하기 때문에 직접 인자를 주입하는 방식으로 구현해야 한다.

또한 생성자 함수인 Object와 인스턴스인 객체 리터럴 사이에는 this를 통한 연결이 불가능하기 때문에 this의 사용을 포기하고 대상 인스턴스를 인자로 직접 주입해야 하는 방식으로 구현된다.

→ instance.freeze() 안 되고 Object.freeze(instance) 이렇게 써야 함

## 6-2-4 다중 프로토타입 체인

프로토타입 체인을 2단계가 아닌 그 이상으로 연결하는 경우도 얼마든지 가능하다.

대각선의 __proto__를 연결하는 방법은 __proto__가 가리키는 대상, 즉 생성자 함수의 prototype이 연결하고자 하는 상위 생성자 함수의 인스턴스를 바라보게끔 하면 된다.

![Untitled](6-2%20%E1%84%91%E1%85%B3%E1%84%85%E1%85%A9%E1%84%90%E1%85%A9%E1%84%90%E1%85%A1%E1%84%8B%E1%85%B5%E1%86%B8%20%E1%84%8E%E1%85%A6%E1%84%8B%E1%85%B5%E1%86%AB%209d0966da197049a988e78426bbaed6d6/Untitled%206.png)

- 변수 g는 Grade의 인스턴스를 바라본다. Grade의 인스턴스는 여러 개의 인자를 받아 순서대로 인덱싱하고 length가 존재하는둥 배열의 형태를 지니지만, 배열은 아닌 유사배열객체이다.
- 따라서 배열의 메서드들을 직접 쓸 수 없고, 그러기 위해서는 g.__proto__. 즉, Grade.prototype이 배열의 인스턴스를 바라보게 하면 된다.
    
    
    ![Untitled](6-2%20%E1%84%91%E1%85%B3%E1%84%85%E1%85%A9%E1%84%90%E1%85%A9%E1%84%90%E1%85%A1%E1%84%8B%E1%85%B5%E1%86%B8%20%E1%84%8E%E1%85%A6%E1%84%8B%E1%85%B5%E1%86%AB%209d0966da197049a988e78426bbaed6d6/Untitled%207.png)